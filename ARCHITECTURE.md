# ะััะธัะตะบัััะฐ ะฟัะพะตะบัะฐ Naberika

## ะัะพะฑะปะตะผะฐ "God Object"

**ะัะปะพ:** `BlockBuilder.ts` โ 1451 ัััะพะบะฐ ะบะพะดะฐ, ะฒัะฟะพะปะฝัััะธะน ะผะฝะพะถะตััะฒะพ ะพะฑัะทะฐะฝะฝะพััะตะน (ะฐะฝัะธะฟะฐััะตัะฝ God Object)

**ะกัะฐะปะพ:** ะะตะบะพะผะฟะพะทะธัะธั ะฟะพ ะฟัะธะฝัะธะฟะฐะผ **SOLID** ะธ **ะงะธััะพะน ะฐััะธัะตะบัััั**

---

## ะะพะฒะฐั ััััะบัััะฐ

```
src/
โโโ core/                              # ะฏะดัะพ ะฟัะธะปะพะถะตะฝะธั (ะฑะธะทะฝะตั-ะปะพะณะธะบะฐ)
โ   โโโ entities/                      # ะกััะฝะพััะธ
โ   โโโ use-cases/                     # ะกัะตะฝะฐัะธะธ ะธัะฟะพะปัะทะพะฒะฐะฝะธั
โ   โ   โโโ BlockManagementUseCase     # ะะปะฐะฒะฝัะน use case
โ   โโโ ports/                         # ะะฝัะตััะตะนัั (ะบะพะฝััะฐะบัั)
โ   โ   โโโ BlockRepository.ts
โ   โ   โโโ ComponentRegistry.ts
โ   โโโ dto/                           # Data Transfer Objects
โ   โโโ types/                         # ะขะธะฟั TypeScript
โ   โโโ BlockBuilderFacade.ts          # ๐ฏ ะะปะฐะฒะฝัะน ัะฐัะฐะด (API ัะพัะบะฐ ะฒัะพะดะฐ)
โ
โโโ infrastructure/                    # ะะตะฐะปะธะทะฐัะธะธ ะฟะพััะพะฒ
โ   โโโ repositories/
โ   โ   โโโ MemoryBlockRepositoryImpl
โ   โ   โโโ LocalStorageBlockRepositoryImpl
โ   โโโ registries/
โ       โโโ MemoryComponentRegistry
โ
โโโ ui/                                # UI ัะปะพะน
    โโโ controllers/
    โ   โโโ BlockUIController.ts       # ะะพะพัะดะธะฝะฐัะพั UI ะพะฟะตัะฐัะธะน
    โโโ services/
        โโโ StyleManager.ts            # ะฃะฟัะฐะฒะปะตะฝะธะต ััะธะปัะผะธ
        โโโ FormBuilder.ts             # ะะตะฝะตัะฐัะธั HTML ัะพัะผ
        โโโ ModalManager.ts            # ะฃะฟัะฐะฒะปะตะฝะธะต ะผะพะดะฐะปัะฝัะผะธ ะพะบะฝะฐะผะธ
        โโโ UIRenderer.ts              # ะะตะฝะดะตัะธะฝะณ UI ะธ ะฑะปะพะบะพะฒ
```

---

## ะัะธะผะตะฝัะฝะฝัะต ะฟะฐััะตัะฝั ะธ ะฟัะธะฝัะธะฟั

### 1. **SOLID ะฟัะธะฝัะธะฟั**

#### Single Responsibility Principle (SRP)
- โ `StyleManager` โ ัะพะปัะบะพ ััะธะปะธ
- โ `FormBuilder` โ ัะพะปัะบะพ ัะพัะผั
- โ `ModalManager` โ ัะพะปัะบะพ ะผะพะดะฐะปัะฝัะต ะพะบะฝะฐ
- โ `UIRenderer` โ ัะพะปัะบะพ ัะตะฝะดะตัะธะฝะณ
- โ `BlockUIController` โ ัะพะปัะบะพ ะบะพะพัะดะธะฝะฐัะธั UI

#### Dependency Inversion Principle (DIP)
- ะะฐะฒะธัะธะผะพััะธ ะพั ะฐะฑัััะฐะบัะธะน (ะธะฝัะตััะตะนัะพะฒ), ะฐ ะฝะต ะพั ะบะพะฝะบัะตัะฝัั ัะตะฐะปะธะทะฐัะธะน
- Use Cases ะทะฐะฒะธััั ะพั `IBlockRepository` ะธ `IComponentRegistry` (ะฟะพััั)

### 2. **ะะฐััะตัะฝั ะฟัะพะตะบัะธัะพะฒะฐะฝะธั**

#### Facade Pattern
**`BlockBuilderFacade`** โ ัะฟัะพััะฝะฝัะน ะธะฝัะตััะตะนั ะดะปั ะฟะพะปัะทะพะฒะฐัะตะปะตะน ะฟะฐะบะตัะฐ
```typescript
const builder = new BlockBuilder({
  containerId: 'app',
  blockConfigs: configs
});
```

#### Strategy Pattern
ะัะฑะพั ัะตะฟะพะทะธัะพัะธั ัะตัะตะท ะพะฟัะธะธ:
```typescript
storage: 'memory' | 'localStorage'
```

#### Factory Pattern
```typescript
private createDefaultRepository(storage?: string): IBlockRepository
```

#### MVC (Controller)
**`BlockUIController`** โ ะบะพะฝััะพะปะปะตั, ะบะพะพัะดะธะฝะธััััะธะน UI ะพะฟะตัะฐัะธะธ

### 3. **ะงะธััะฐั ะฐััะธัะตะบัััะฐ**

#### ะกะปะพะธ ะธ ะทะฐะฒะธัะธะผะพััะธ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ           UI Layer                       โ
โ  (controllers, services)                 โ
โ                                          โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ     Core Layer                      โ โ
โ  โ  (use-cases, entities, ports)      โ โ
โ  โ                                     โ โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ โ
โ  โ  โ  Infrastructure Layer        โ  โ โ
โ  โ  โ  (ัะตะฐะปะธะทะฐัะธะธ ะฟะพััะพะฒ)         โ  โ โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะัะฐะฒะธะปะพ ะทะฐะฒะธัะธะผะพััะตะน:** ะฒะฝะตัะฝะธะต ัะปะพะธ ะทะฐะฒะธััั ะพั ะฒะฝัััะตะฝะฝะธั, ะฝะพ ะฝะต ะฝะฐะพะฑะพัะพั

โ **ะะฐะทัะตัะตะฝะพ:**
- UI โ Use Case
- Use Case โ Entity
- Use Case โ Port (ะธะฝัะตััะตะนั)
- Infrastructure โ Port

โ **ะะฐะฟัะตัะตะฝะพ:**
- Core โ Infrastructure
- Core โ UI
- Entity โ Use Case

---

## ะกัะฐะฒะฝะตะฝะธะต: ะัะปะพ vs ะกัะฐะปะพ

### ะัะปะพ (God Object)
```typescript
class BlockBuilder {
  // 1451 ัััะพะบะฐ ะบะพะดะฐ
  // ะัะฒะตัััะฒะตะฝะฝะพััะธ:
  // - API ัะฐัะฐะด
  // - ะะตะฝะดะตัะธะฝะณ UI
  // - ะะตะฝะตัะฐัะธั ัะพัะผ
  // - ะะพะดะฐะปัะฝัะต ะพะบะฝะฐ
  // - ะกัะธะปะธ
  // - ะะฐะปะธะดะฐัะธั
  // - ะะฑัะฐะฑะพััะธะบะธ ัะพะฑััะธะน
  // ... ะธ ะผะฝะพะณะพะต ะดััะณะพะต
}
```

### ะกัะฐะปะพ (ะงะธััะฐั ะฐััะธัะตะบัััะฐ)

#### BlockBuilderFacade (137 ัััะพะบ)
- ะขะพะปัะบะพ API ัะฐัะฐะด
- ะะตะปะตะณะธัะพะฒะฐะฝะธะต ะฒัะทะพะฒะพะฒ Use Cases ะธ UI ะบะพะฝััะพะปะปะตัั

#### BlockUIController (233 ัััะพะบะธ)
- ะะพะพัะดะธะฝะฐัะธั UI ะพะฟะตัะฐัะธะน
- Dependency Injection ัะตัะฒะธัะพะฒ

#### StyleManager (181 ัััะพะบะฐ)
- ะขะพะปัะบะพ ัะฟัะฐะฒะปะตะฝะธะต ััะธะปัะผะธ

#### FormBuilder (285 ัััะพะบ)
- ะขะพะปัะบะพ ะณะตะฝะตัะฐัะธั ะธ ะฒะฐะปะธะดะฐัะธั ัะพัะผ

#### ModalManager (94 ัััะพะบะธ)
- ะขะพะปัะบะพ ัะฟัะฐะฒะปะตะฝะธะต ะผะพะดะฐะปัะฝัะผะธ ะพะบะฝะฐะผะธ

#### UIRenderer (168 ัััะพะบ)
- ะขะพะปัะบะพ ัะตะฝะดะตัะธะฝะณ UI ะธ ะฑะปะพะบะพะฒ

---

## ะัะตะธะผััะตััะฒะฐ ะฝะพะฒะพะน ะฐััะธัะตะบัััั

### 1. **ะขะตััะธััะตะผะพััั**
ะะฐะถะดัะน ะบะปะฐัั ะผะพะถะฝะพ ัะตััะธัะพะฒะฐัั ะธะทะพะปะธัะพะฒะฐะฝะฝะพ:
```typescript
const formBuilder = new FormBuilder();
const validation = formBuilder.validateForm(props, fields);
```

### 2. **ะะพะดะดะตัะถะธะฒะฐะตะผะพััั**
- ะะทะผะตะฝะตะฝะธั ะฒ ััะธะปัั โ ะฟัะฐะฒะธะผ ัะพะปัะบะพ `StyleManager`
- ะะทะผะตะฝะตะฝะธั ะฒ ัะพัะผะฐั โ ะฟัะฐะฒะธะผ ัะพะปัะบะพ `FormBuilder`
- ะะทะผะตะฝะตะฝะธั ะฒ UI โ ะฟัะฐะฒะธะผ ัะพะปัะบะพ `UIRenderer`

### 3. **ะะฐััะธััะตะผะพััั**
ะะตะณะบะพ ะดะพะฑะฐะฒะธัั ะฝะพะฒัะน ััะฝะบัะธะพะฝะฐะป:
```typescript
export class ThemeManager {
  applyDarkTheme() { ... }
  applyLightTheme() { ... }
}
```

### 4. **ะะตัะตะธัะฟะพะปัะทะพะฒะฐะฝะธะต**
ะกะตัะฒะธัั ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ะพัะดะตะปัะฝะพ:
```typescript
import { FormBuilder, StyleManager } from 'naberika';

const formBuilder = new FormBuilder();
const html = formBuilder.generateCreateFormHTML(fields);
```

### 5. **Dependency Injection**

**ะัะธะฝัะธะฟ:** ะะฐะฒะธัะธะผะพััะธ ะฟะตัะตะดะฐัััั ัะตัะตะท ะบะพะฝััััะบัะพั, ะฐ ะฝะต ัะพะทะดะฐัััั ะฒะฝัััะธ ะบะปะฐััะฐ.

#### BlockBuilderFacade
ะกะพะทะดะฐะตั ะฒัะต ะทะฐะฒะธัะธะผะพััะธ Infrastructure ัะปะพั ะธ ะฟะตัะตะดะฐะตั ะธั ะฒ Use Cases:

```typescript
// ะกะพะทะดะฐะฝะธะต HTTP ะบะปะธะตะฝัะฐ (Infrastructure)
this.httpClient = new FetchHttpClient();

// ะกะพะทะดะฐะฝะธะต ApiSelectUseCase ั ะฒะฝะตะดัะตะฝะธะตะผ ะทะฐะฒะธัะธะผะพััะธ
this.apiSelectUseCase = new ApiSelectUseCase(this.httpClient);

// ะะตัะตะดะฐัะฐ ะฒ UI Controller
this.uiController = new BlockUIController({
  // ...
  apiSelectUseCase: this.apiSelectUseCase
});
```

#### BlockUIController
ะะพะปััะฐะตั ะทะฐะฒะธัะธะผะพััะธ ะธ ะฟะตัะตะดะฐะตั ะธั ะดะฐะปััะต:

```typescript
constructor(config: IBlockUIControllerConfig) {
  this.apiSelectUseCase = config.apiSelectUseCase;
  this.uiRenderer = new UIRenderer(...);
  this.formBuilder = new FormBuilder();
  this.modalManager = new ModalManager();
  this.styleManager = new StyleManager();
}
```

#### ApiSelectControlRenderer (Pure JS)
ะะพะปััะฐะตั ApiSelectUseCase ัะตัะตะท ะบะพะฝััััะบัะพั:

```typescript
constructor(options: IApiSelectControlOptions) {
  this.apiSelectUseCase = options.apiSelectUseCase; // ะะฝะตะดัะตะฝะธะต ะทะฐะฒะธัะธะผะพััะธ
}
```

#### ApiSelectField.vue
ะะพะปััะฐะตั ApiSelectUseCase ัะตัะตะท props:

```vue
<script setup lang="ts">
interface IProps {
  apiSelectUseCase: ApiSelectUseCase; // ะะฝะตะดัะตะฝะธะต ะทะฐะฒะธัะธะผะพััะธ
}

const props = defineProps<IProps>();
const apiSelectUseCase = props.apiSelectUseCase;
</script>
```

**ะัะตะธะผััะตััะฒะฐ:**
- โ UI ะฝะต ะทะฐะฒะธัะธั ะพั Infrastructure ัะปะพั
- โ ะะตะณะบะพ ัะตััะธัะพะฒะฐัั ั mock ัะตะฐะปะธะทะฐัะธัะผะธ
- โ ะกะพะฑะปัะดะฐะตััั ะธะฝะฒะตััะธั ะทะฐะฒะธัะธะผะพััะตะน (SOLID)
- โ ะะดะธะฝััะฒะตะฝะฝัะน ัะบะทะตะผะฟะปัั HTTP ะบะปะธะตะฝัะฐ ะฝะฐ ะฒัั ะฟัะธะปะพะถะตะฝะธะต

---

## API ัะพะฒะผะตััะธะผะพััั

**API ะพััะฐะปัั ะฟะพะปะฝะพัััั ัะพะฒะผะตััะธะผัะผ!** ะกััะตััะฒัััะธะน ะบะพะด ะฟะพะปัะทะพะฒะฐัะตะปะตะน ัะฐะฑะพัะฐะตั ะฑะตะท ะธะทะผะตะฝะตะฝะธะน:

```typescript
// ะะพ ัะตัะฐะบัะพัะธะฝะณะฐ
import { BlockBuilder } from 'naberika';
const builder = new BlockBuilder({ ... });

// ะะพัะปะต ัะตัะฐะบัะพัะธะฝะณะฐ - ะขะะข ะะ ะะะ ะะะะะขะะะข!
import { BlockBuilder } from 'naberika';
const builder = new BlockBuilder({ ... });
```

---

## ะกะพะพัะฒะตัััะฒะธะต ะฟัะฐะฒะธะปะฐะผ ะฟัะพะตะบัะฐ

โ **ะงะธััะฐั ะฐััะธัะตะบัััะฐ** โ ัััะพะณะพะต ัะฐะทะดะตะปะตะฝะธะต ะฝะฐ ัะปะพะธ  
โ **SOLID ะฟัะธะฝัะธะฟั** โ ะบะฐะถะดัะน ะบะปะฐัั ะธะผะตะตั ะพะดะฝั ะพัะฒะตัััะฒะตะฝะฝะพััั  
โ **ะงะธัััะต ััะฝะบัะธะธ** โ ะผะตัะพะดั ะฑะตะท ะฟะพะฑะพัะฝัั ัััะตะบัะพะฒ ะณะดะต ะฒะพะทะผะพะถะฝะพ  
โ **ะกะพะฒัะตะผะตะฝะฝัะต ะฟะฐััะตัะฝั** โ Facade, Strategy, Factory, MVC  
โ **TypeScript best practices** โ ะธะฝัะตััะตะนัั ะฝะฐัะธะฝะฐัััั ั `I`, ัะธะฟั ั `T`  
โ **ะะญะ** โ ะบะปะฐััั CSS ะฟะพ ะผะตัะพะดะพะปะพะณะธะธ ะะญะ

---

## ะะตััะธะบะธ ะบะฐัะตััะฒะฐ ะบะพะดะฐ

### ะัะปะพ
- 1 ัะฐะนะป: 1451 ัััะพะบะฐ
- ะฆะธะบะปะพะผะฐัะธัะตัะบะฐั ัะปะพะถะฝะพััั: ะฒััะพะบะฐั
- ะกะฒัะทะฐะฝะฝะพััั (coupling): ะฒััะพะบะฐั
- ะขะตััะธััะตะผะพััั: ะฝะธะทะบะฐั

### ะกัะฐะปะพ
- 6 ะบะปะฐััะพะฒ ัะพ ััะตะดะฝะธะผ ัะฐะทะผะตัะพะผ ~165 ัััะพะบ
- ะฆะธะบะปะพะผะฐัะธัะตัะบะฐั ัะปะพะถะฝะพััั: ะฝะธะทะบะฐั
- ะกะฒัะทะฐะฝะฝะพััั (coupling): ะฝะธะทะบะฐั
- ะกะฒัะทะฝะพััั (cohesion): ะฒััะพะบะฐั
- ะขะตััะธััะตะผะพััั: ะฒััะพะบะฐั

---

## ะะฐะปัะฝะตะนัะธะต ัะปัััะตะฝะธั

1. **Unit ัะตััั** ะดะปั ะบะฐะถะดะพะณะพ ัะตัะฒะธัะฐ
2. **Integration ัะตััั** ะดะปั BlockUIController
3. **E2E ัะตััั** ะดะปั ะฟะพะปะฝะพะณะพ ััะตะฝะฐัะธั
4. **ะะพะฟะพะปะฝะธัะตะปัะฝัะต ัะตัะฒะธัั:**
   - `ThemeManager` โ ัะฟัะฐะฒะปะตะฝะธะต ัะตะผะฐะผะธ
   - `LocalizationService` โ ะปะพะบะฐะปะธะทะฐัะธั
   - `EventBus` โ ัะพะฑััะธั ะฟัะธะปะพะถะตะฝะธั
5. **ะะพะบัะผะตะฝัะฐัะธั API** โ JSDoc ะบะพะผะผะตะฝัะฐัะธะธ

