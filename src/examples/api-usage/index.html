<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlockBuilder API - –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            background: #f5f5f5;
        }
        .app {
            height: 100vh;
            display: flex;
            flex-direction: column;
            background: #f8f9fa;
        }
        .app-header {
            background: white;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
        }
        .app-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }
        .app-description {
            color: #666;
            margin-top: 10px;
            font-size: 14px;
        }
        .api-demo {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .api-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .api-button:hover {
            background: #0056b3;
        }
        .api-output {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            margin-top: 15px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .block-item {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 4px;
            padding: 10px;
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="app">
        <div class="app-header">
            <h1>BlockBuilder API - –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</h1>
            <div class="app-description">
                –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ BlockBuilder API –±–µ–∑ UI.
                –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç –≤ —Å–≤–æ–µ–º –ø—Ä–æ–µ–∫—Ç–µ.
            </div>
        </div>

        <div class="app-content">
            <div class="api-demo">
                <h3>üéØ API –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è</h3>
                <p>–≠—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π BlockBuilder API:</p>

                <button class="api-button" onclick="createTextBlock()">üìù –°–æ–∑–¥–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫</button>
                <button class="api-button" onclick="createImageBlock()">üñºÔ∏è –°–æ–∑–¥–∞—Ç—å –±–ª–æ–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</button>
                <button class="api-button" onclick="getAllBlocks()">üìã –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –±–ª–æ–∫–∏</button>
                <button class="api-button" onclick="clearAllBlocks()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ</button>

                <div id="api-output" class="api-output">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫–∏ –≤—ã—à–µ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ API</div>
            </div>

            <div class="api-demo">
                <h3>üì¶ –°–æ–∑–¥–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏</h3>
                <div id="blocks-list">
                    <p>–ë–ª–æ–∫–∏ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å...</p>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π BlockBuilder API
        import { BlockBuilder } from '/dist/index.esm.js';
        import { blockConfigs } from './block-config.js';

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ API (–±–µ–∑ UI)
        const blockBuilder = new BlockBuilder({
            containerId: 'api-demo', // –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è UI
            blockConfigs: blockConfigs,
            storage: 'memory'
        });

        // –î–µ–ª–∞–µ–º API –¥–æ—Å—Ç—É–ø–Ω—ã–º –≥–ª–æ–±–∞–ª—å–Ω–æ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
        window.blockBuilder = blockBuilder;

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ API
        window.createTextBlock = async () => {
            try {
                const block = await blockBuilder.createBlock({
                    type: 'text',
                    settings: { fontSize: 18 },
                    props: {
                        content: '–ü—Ä–∏–≤–µ—Ç, –º–∏—Ä!',
                        color: '#333333',
                        textAlign: 'left'
                    }
                });
                updateOutput(`‚úÖ –°–æ–∑–¥–∞–Ω —Ç–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫: ${JSON.stringify(block, null, 2)}`);
                await refreshBlocksList();
            } catch (error) {
                updateOutput(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
            }
        };

        window.createImageBlock = async () => {
            try {
                const block = await blockBuilder.createBlock({
                    type: 'image',
                    settings: { width: 300 },
                    props: {
                        src: 'https://via.placeholder.com/300x200',
                        alt: '–î–µ–º–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ',
                        caption: '–≠—Ç–æ –¥–µ–º–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ'
                    }
                });
                updateOutput(`‚úÖ –°–æ–∑–¥–∞–Ω –±–ª–æ–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: ${JSON.stringify(block, null, 2)}`);
                await refreshBlocksList();
            } catch (error) {
                updateOutput(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
            }
        };

        window.getAllBlocks = async () => {
            try {
                const blocks = await blockBuilder.getAllBlocks();
                updateOutput(`üìã –í—Å–µ–≥–æ –±–ª–æ–∫–æ–≤: ${blocks.length}\n${JSON.stringify(blocks, null, 2)}`);
                await refreshBlocksList();
            } catch (error) {
                updateOutput(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
            }
        };

        window.clearAllBlocks = async () => {
            try {
                await blockBuilder.clearAllBlocks();
                updateOutput(`üóëÔ∏è –í—Å–µ –±–ª–æ–∫–∏ —É–¥–∞–ª–µ–Ω—ã`);
                await refreshBlocksList();
            } catch (error) {
                updateOutput(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
            }
        };

        function updateOutput(message) {
            document.getElementById('api-output').textContent = message;
        }

        async function refreshBlocksList() {
            try {
                const blocks = await blockBuilder.getAllBlocks();
                const blocksList = document.getElementById('blocks-list');

                if (blocks.length === 0) {
                    blocksList.innerHTML = '<p>–ë–ª–æ–∫–æ–≤ –Ω–µ—Ç</p>';
                    return;
                }

                blocksList.innerHTML = blocks.map(block => `
                    <div class="block-item">
                        <strong>${block.type}</strong> (ID: ${block.id})
                        <br>
                        <small>–°–æ–∑–¥–∞–Ω: ${new Date(block.metadata?.createdAt).toLocaleString()}</small>
                        <br>
                        <small>–ü—Ä–æ–ø—Å—ã: ${JSON.stringify(block.props)}</small>
                    </div>
                `).join('');
            } catch (error) {
                document.getElementById('blocks-list').innerHTML = `<p>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–ª–æ–∫–æ–≤: ${error.message}</p>`;
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        console.log('‚úÖ BlockBuilder API –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
        console.log('üì¶ –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∏–ø—ã –±–ª–æ–∫–æ–≤:', blockBuilder.getAvailableBlockTypes());

        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –±–ª–æ–∫–∏
        refreshBlocksList();
    </script>
</body>
</html>
