<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Naberika - –ß–∏—Å—Ç—ã–π JavaScript</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .demo-section {
            margin-bottom: 40px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #4facfe;
        }

        .demo-section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .btn-info {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
        }

        .blocks-container {
            width: 100%;
            margin: 20px 0;
        }

        .block {
            width: 100%;
            margin-bottom: 30px;
            border: 2px solid #007bff;
            border-radius: 8px;
            background: rgba(0, 123, 255, 0.05);
            transition: all 0.3s ease;
            overflow: hidden;
            position: relative;
        }

        .block:hover {
            background: rgba(0, 123, 255, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.2);
        }

        .block.selected {
            border-color: #28a745;
            background: rgba(40, 167, 69, 0.1);
            box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.2);
        }

        .block.locked {
            border-color: #dc3545;
            background: rgba(220, 53, 69, 0.05);
        }

        .block-header {
            background: rgba(0, 123, 255, 0.1);
            padding: 10px 15px;
            border-bottom: 1px solid #007bff;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            color: #2c3e50;
        }

        .block-content {
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #333;
            min-height: 60px;
        }

        .block.hidden {
            opacity: 0.3;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-card h3 {
            color: #333;
            margin-bottom: 10px;
        }

        .stat-card .number {
            font-size: 2rem;
            font-weight: bold;
            color: #4facfe;
        }

        .log {
            background: #1e1e1e;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }

        .log-entry {
            margin-bottom: 8px;
            padding: 4px 0;
        }

        .log-entry.success {
            color: #50fa7b;
        }

        .log-entry.error {
            color: #ff5555;
        }

        .log-entry.info {
            color: #8be9fd;
        }

        .log-entry.warning {
            color: #ffb86c;
        }

        .architecture-diagram {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid #e9ecef;
        }

        .architecture-diagram h3 {
            color: #333;
            margin-bottom: 15px;
            text-align: center;
        }

        .layer {
            padding: 15px;
            margin: 10px 0;
            border-radius: 6px;
            text-align: center;
            font-weight: 600;
        }

        .layer-core {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .layer-infrastructure {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .layer-ui {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }

        .arrow {
            text-align: center;
            font-size: 1.5rem;
            color: #666;
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèóÔ∏è Naberika - –ß–∏—Å—Ç—ã–π JavaScript</h1>
            <p>–ë–ª–æ—á–Ω—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Å —á–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π</p>
        </div>

        <div class="content">
            <!-- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ -->
            <div class="demo-section">
                <h2>üéØ –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</h2>
                <div class="architecture-diagram">
                    <h3>–°–ª–æ–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã</h3>
                    <div class="layer layer-ui">üé® UI Layer</div>
                    <div class="arrow">‚¨áÔ∏è</div>
                    <div class="layer layer-core">üéØ Core Layer (Use Cases)</div>
                    <div class="arrow">‚¨áÔ∏è</div>
                    <div class="layer layer-infrastructure">üîß Infrastructure Layer</div>
                </div>
            </div>

            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∞–º–∏ -->
            <div class="demo-section">
                <h2>üì¶ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∞–º–∏</h2>
                <div class="controls">
                    <button class="btn btn-primary" onclick="addTextBlock()">
                        üìù –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç
                    </button>
                    <button class="btn btn-success" onclick="addImageBlock()">
                        üñºÔ∏è –î–æ–±–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                    </button>
                    <button class="btn btn-info" onclick="addButtonBlock()">
                        üîò –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É
                    </button>
                    <button class="btn btn-warning" onclick="addContainerBlock()">
                        üì¶ –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
                    </button>
                    <button class="btn btn-danger" onclick="clearAllBlocks()">
                        üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ
                    </button>
                </div>

                <div class="blocks-container" id="blocks-container"></div>

                <div class="stats">
                    <div class="stat-card">
                        <h3>–í—Å–µ–≥–æ –±–ª–æ–∫–æ–≤</h3>
                        <div class="number" id="totalBlocks">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>–í—ã–±—Ä–∞–Ω–Ω—ã–π –±–ª–æ–∫</h3>
                        <div class="number" id="selectedBlock">-</div>
                    </div>
                    <div class="stat-card">
                        <h3>–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ</h3>
                        <div class="number" id="lockedBlocks">0</div>
                    </div>
                </div>
            </div>

            <!-- –õ–æ–≥ -->
            <div class="demo-section">
                <h2>üìã –õ–æ–≥ –æ–ø–µ—Ä–∞—Ü–∏–π</h2>
                <div class="log" id="log"></div>
            </div>
        </div>
    </div>

    <script type="module">
        // –ò–º–ø–æ—Ä—Ç Naberika (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ)
        // import { BlockManagementUseCase, MemoryBlockRepositoryImpl, MemoryComponentRegistry } from '../index.js';

        // –ò–º–∏—Ç–∞—Ü–∏—è Naberika –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
        class SimpleBlock {
            constructor(data) {
                this.id = `block_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
                this.type = data.type;
                this.settings = data.settings || {};
                this.props = data.props || {};
                this.template = data.template;
                this.visible = data.visible !== false;
                this.locked = data.locked || false;
                this.selected = false;
            }

            updateSettings(newSettings) {
                this.settings = { ...this.settings, ...newSettings };
            }

            updateProps(newProps) {
                this.props = { ...this.props, ...newProps };
            }

            setLocked(locked) {
                this.locked = locked;
            }

            setVisible(visible) {
                this.visible = visible;
            }

            setSelected(selected) {
                this.selected = selected;
            }
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let blocks = [];
        let selectedBlockId = null;

        // –£—Ç–∏–ª–∏—Ç—ã
        function log(message, type = 'info') {
            const logElement = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${timestamp}] ${message}`;
            logElement.appendChild(entry);
            logElement.scrollTop = logElement.scrollHeight;
        }

        function updateStats() {
            document.getElementById('totalBlocks').textContent = blocks.length;
            document.getElementById('selectedBlock').textContent = selectedBlockId || '-';
            document.getElementById('lockedBlocks').textContent = blocks.filter(b => b.locked).length;
        }

        function renderBlocks() {
            const container = document.getElementById('blocks-container');
            container.innerHTML = '';

            blocks.forEach(block => {
                if (!block.visible) return;

                const blockElement = document.createElement('div');
                blockElement.className = 'block';
                blockElement.id = block.id;
                
                if (block.selected) blockElement.classList.add('selected');
                if (block.locked) blockElement.classList.add('locked');
                if (!block.visible) blockElement.classList.add('hidden');

                // –°–æ–∑–¥–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –±–ª–æ–∫–∞
                const headerElement = document.createElement('div');
                headerElement.className = 'block-header';
                headerElement.innerHTML = `
                    <span><strong>${block.type}</strong> - ${block.id}</span>
                    ${block.locked ? '<span>üîí</span>' : ''}
                `;

                // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –±–ª–æ–∫–∞
                const contentElement = document.createElement('div');
                contentElement.className = 'block-content';

                // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∏–ª–∏ –∏–∑ settings
                Object.entries(block.settings).forEach(([key, value]) => {
                    contentElement.style[key] = value;
                });

                // –†–µ–Ω–¥–µ—Ä–∏–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ template
                if (block.template) {
                    let content = block.template;
                    Object.entries(block.props).forEach(([key, value]) => {
                        content = content.replace(new RegExp(`{{ props.${key} }}`, 'g'), value);
                    });
                    Object.entries(block.settings).forEach(([key, value]) => {
                        content = content.replace(new RegExp(`{{ settings.${key} }}`, 'g'), value);
                    });
                    contentElement.innerHTML = content;
                } else {
                    contentElement.textContent = block.props.content || block.type;
                }

                blockElement.appendChild(headerElement);
                blockElement.appendChild(contentElement);

                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
                blockElement.addEventListener('click', (e) => {
                    e.stopPropagation();
                    selectBlock(block.id);
                });

                container.appendChild(blockElement);
            });
        }

        function selectBlock(blockId) {
            blocks.forEach(block => block.setSelected(block.id === blockId));
            selectedBlockId = blockId;
            updateStats();
            renderBlocks();
            
            const block = blocks.find(b => b.id === blockId);
            if (block) {
                log(`–í—ã–±—Ä–∞–Ω –±–ª–æ–∫: ${block.type} (${blockId})`, 'success');
            }
        }

        // –§—É–Ω–∫—Ü–∏—è drag & drop —É–¥–∞–ª–µ–Ω–∞ - –±–ª–æ–∫–∏ —Ç–µ–ø–µ—Ä—å —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è –∫–∞–∫ —Å–µ–∫—Ü–∏–∏ —Å–∞–π—Ç–∞

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±–ª–æ–∫–æ–≤
        window.addTextBlock = function() {
            const block = new SimpleBlock({
                type: 'text',
                settings: {
                    fontSize: '16px',
                    color: '#333',
                    backgroundColor: '#f8f9fa',
                    padding: '10px',
                    borderRadius: '4px',
                    border: '1px solid #dee2e6'
                },
                props: {
                    content: '–¢–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫',
                    textAlign: 'center'
                },
                template: '<div style="text-align: {{ props.textAlign }}; font-size: {{ settings.fontSize }}; color: {{ settings.color }};">{{ props.content }}</div>',
            });

            blocks.push(block);
            selectBlock(block.id);
            updateStats();
            renderBlocks();
            log(`–î–æ–±–∞–≤–ª–µ–Ω —Ç–µ–∫—Å—Ç–æ–≤—ã–π –±–ª–æ–∫: ${block.id}`, 'success');
        };

        window.addImageBlock = function() {
            const block = new SimpleBlock({
                type: 'image',
                settings: {
                    border: '2px solid #007bff',
                    borderRadius: '8px',
                    overflow: 'hidden'
                },
                props: {
                    src: 'https://via.placeholder.com/200x150/007bff/ffffff?text=Image',
                    alt: 'Placeholder Image'
                },
                template: '<img src="{{ props.src }}" alt="{{ props.alt }}" style="width: 100%; height: 100%; object-fit: cover;">',
            });

            blocks.push(block);
            selectBlock(block.id);
            updateStats();
            renderBlocks();
            log(`–î–æ–±–∞–≤–ª–µ–Ω –±–ª–æ–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: ${block.id}`, 'success');
        };

        window.addButtonBlock = function() {
            const block = new SimpleBlock({
                type: 'button',
                settings: {
                    backgroundColor: '#007bff',
                    color: 'white',
                    border: 'none',
                    borderRadius: '6px',
                    cursor: 'pointer',
                    fontSize: '14px',
                    fontWeight: '600'
                },
                props: {
                    text: '–ù–∞–∂–º–∏ –º–µ–Ω—è!',
                    variant: 'primary'
                },
                template: '<button style="width: 100%; height: 100%; background-color: {{ settings.backgroundColor }}; color: {{ settings.color }}; border: {{ settings.border }}; border-radius: {{ settings.borderRadius }}; cursor: {{ settings.cursor }}; font-size: {{ settings.fontSize }}; font-weight: {{ settings.fontWeight }};">{{ props.text }}</button>',
            });

            blocks.push(block);
            selectBlock(block.id);
            updateStats();
            renderBlocks();
            log(`–î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞: ${block.id}`, 'success');
        };

        window.addContainerBlock = function() {
            const block = new SimpleBlock({
                type: 'container',
                settings: {
                    backgroundColor: '#f8f9fa',
                    border: '2px dashed #6c757d',
                    borderRadius: '8px',
                    padding: '20px'
                },
                props: {
                    title: '–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä',
                    content: '–≠—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –¥—Ä—É–≥–∏—Ö –±–ª–æ–∫–æ–≤'
                },
                template: '<div style="text-align: center;"><h3 style="margin: 0 0 10px 0; color: #333;">{{ props.title }}</h3><p style="margin: 0; color: #666;">{{ props.content }}</p></div>',
            });

            blocks.push(block);
            selectBlock(block.id);
            updateStats();
            renderBlocks();
            log(`–î–æ–±–∞–≤–ª–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä: ${block.id}`, 'success');
        };

        window.clearAllBlocks = function() {
            blocks = [];
            selectedBlockId = null;
            updateStats();
            renderBlocks();
            log('–í—Å–µ –±–ª–æ–∫–∏ —É–¥–∞–ª–µ–Ω—ã', 'warning');
        };

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
        document.addEventListener('keydown', (e) => {
            if (selectedBlockId) {
                const block = blocks.find(b => b.id === selectedBlockId);
                if (!block) return;

                switch(e.key) {
                    case 'Delete':
                    case 'Backspace':
                        blocks = blocks.filter(b => b.id !== selectedBlockId);
                        selectedBlockId = null;
                        updateStats();
                        renderBlocks();
                        log('–ë–ª–æ–∫ —É–¥–∞–ª–µ–Ω', 'error');
                        break;
                    case 'l':
                    case 'L':
                        block.setLocked(!block.locked);
                        renderBlocks();
                        log(`–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∞: ${block.locked}`, 'info');
                        break;
                    case 'h':
                    case 'H':
                        block.setVisible(!block.visible);
                        renderBlocks();
                        log(`–í–∏–¥–∏–º–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∞: ${block.visible}`, 'info');
                        break;
                }
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        log('Naberika –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω - –ß–∏—Å—Ç—ã–π JavaScript', 'success');
        log('–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±–ª–æ–∫–æ–≤', 'info');
        log('–ö–ª–∏–∫–Ω–∏—Ç–µ –ø–æ –±–ª–æ–∫—É –¥–ª—è –≤—ã–±–æ—Ä–∞, –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è', 'info');
        log('–ö–ª–∞–≤–∏—à–∏: Delete - —É–¥–∞–ª–∏—Ç—å, L - –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å, H - —Å–∫—Ä—ã—Ç—å', 'info');
        updateStats();
    </script>
</body>
</html>
